#!/bin/sh
#
# chkconfig: 345 99 01
# description: news task worker
#

TASKSERVERHOST=ip-10-152-166-240.ec2.internal

case $1 in
    start)
        echo "TaskWorker starting"
        /usr/bin/java -Xmx3g -cp "/news/lib/*" edu.stanford.pcl.news.task.TaskWorker service --taskserver=$TASKSERVERHOST &
        ;;
    restart)
        echo "TaskWorker stopping"
        if pgrep -f "TaskWorker service"; then
            kill `pgrep -f "TaskWorker service"`
        fi
        echo "TaskWorker starting"
        /usr/bin/java -Xmx3g -cp "/news/lib/*" edu.stanford.pcl.news.task.TaskWorker service --taskserver=$TASKSERVERHOST &
        ;;
    status)
        if pgrep -f "TaskWorker service"; then
            echo "TaskWorker running"
        else
            echo "TaskWorker stopped"
        fi
        ;;
    stop)
        echo "TaskWorker stopping"
        if pgrep -f "TaskWorker service"; then
            kill `pgrep -f "TaskWorker service"`
        else
            echo "TaskWorker already stopped"
        fi
        ;;
esac
